<!doctype html>
<html lang="it">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Esercizi di Grammatica Cinese</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea, #764ba2);
            min-height: 100%;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .main-title {
            font-size: 42px;
            color: #2c3e50;
            margin: 0 0 10px 0;
            font-weight: bold;
        }

        .subtitle {
            font-size: 18px;
            color: #7f8c8d;
            margin: 0;
        }

        .exercise-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .exercise-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
            text-align: center;
        }

        .exercise-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-color: #667eea;
        }

        .exercise-card.active {
            border-color: #764ba2;
            background: linear-gradient(135deg, #fff5f5, #f8f9fa);
        }

        .exercise-title {
            font-size: 20px;
            color: #2c3e50;
            margin: 0 0 10px 0;
            font-weight: bold;
        }

        .exercise-description {
            color: #6c757d;
            font-size: 14px;
            margin-bottom: 15px;
        }

        .start-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .start-btn:hover {
            background: #5a6fd8;
            transform: scale(1.05);
        }

        .exercise-area {
            display: none;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-top: 20px;
        }

        .exercise-area.active {
            display: block;
        }

        .progress-bar {
            background: #e9ecef;
            border-radius: 10px;
            height: 8px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #667eea, #764ba2);
            height: 100%;
            transition: width 0.3s ease;
        }

        .question-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .question-text {
            font-size: 18px;
            color: #2c3e50;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .chinese-text {
            font-size: 24px;
            color: #e74c3c;
            font-weight: bold;
            text-align: center;
            margin: 15px 0;
            padding: 15px;
            background: #fff5f5;
            border-radius: 8px;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin: 20px 0;
        }

        .option-btn {
            background: white;
            border: 2px solid #dee2e6;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .option-btn:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .option-btn.selected {
            background: #667eea;
            color: white;
            border-color: #5a6fd8;
        }

        .option-btn.correct {
            background: #28a745;
            color: white;
            border-color: #1e7e34;
        }

        .option-btn.wrong {
            background: #dc3545;
            color: white;
            border-color: #bd2130;
        }

        .drag-area {
            min-height: 80px;
            background: white;
            border: 2px dashed #dee2e6;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
        }

        .drag-area.drag-over {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .word-chip {
            background: #667eea;
            color: white;
            padding: 8px 12px;
            border-radius: 15px;
            cursor: move;
            font-size: 14px;
            transition: all 0.3s ease;
            user-select: none;
        }

        .word-chip:hover {
            background: #5a6fd8;
            transform: scale(1.05);
        }

        .word-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
            padding: 15px;
            background: #e9ecef;
            border-radius: 10px;
        }

        .word-bank .word-chip {
            background: #6c757d;
        }

        .word-bank .word-chip:hover {
            background: #5a6268;
        }

        .input-field {
            width: 100%;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 16px;
            margin: 10px 0;
            transition: border-color 0.3s ease;
        }

        .input-field:focus {
            outline: none;
            border-color: #667eea;
        }

        .feedback {
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
            font-size: 16px;
            line-height: 1.5;
        }

        .feedback.correct {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .feedback.wrong {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .explanation {
            background: #e7f3ff;
            border: 1px solid #b8daff;
            color: #004085;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 14px;
            line-height: 1.6;
        }

        .score-display {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
            margin: 20px 0;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        .nav-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            background: #5a6268;
        }

        .nav-btn.primary {
            background: #667eea;
        }

        .nav-btn.primary:hover {
            background: #5a6fd8;
        }

        .nav-btn:disabled {
            background: #dee2e6;
            color: #6c757d;
            cursor: not-allowed;
        }

        .final-score {
            text-align: center;
            padding: 40px 20px;
        }

        .final-score h2 {
            font-size: 32px;
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .final-score p {
            font-size: 18px;
            color: #6c757d;
            margin-bottom: 25px;
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="container">
   <header class="header">
    <h1 class="main-title" id="mainTitle">Esercizi di Grammatica Cinese</h1>
    <p class="subtitle" id="subtitle">Impara la grammatica con esercizi interattivi e correzione automatica ğŸ“š</p>
   </header>
   <main id="exerciseSelector" class="exercise-selector">
    <div class="exercise-card" onclick="startExercise('word-order')">
     <h3 class="exercise-title" id="exercise1Title">ğŸ“ Ordine delle Parole</h3>
     <p class="exercise-description">Riordina le parole per formare frasi grammaticalmente corrette</p><button class="start-btn">Inizia Esercizio</button>
    </div>
    <div class="exercise-card" onclick="startExercise('particles')">
     <h3 class="exercise-title" id="exercise2Title">ğŸ”¤ Particelle Grammaticali</h3>
     <p class="exercise-description">Scegli la particella corretta (çš„, äº†, å—, å‘¢, etc.)</p><button class="start-btn">Inizia Esercizio</button>
    </div>
    <div class="exercise-card" onclick="startExercise('verb-tenses')">
     <h3 class="exercise-title" id="exercise3Title">â° Tempi Verbali</h3>
     <p class="exercise-description">Completa le frasi con la forma verbale corretta</p><button class="start-btn">Inizia Esercizio</button>
    </div>
    <div class="exercise-card" onclick="startExercise('classifiers')">
     <h3 class="exercise-title" id="exercise4Title">ğŸ“ Classificatori</h3>
     <p class="exercise-description">Impara a usare i classificatori cinesi (ä¸ª, æœ¬, åª, å¼ , è¾†)</p><button class="start-btn">Inizia Esercizio</button>
    </div>
    <div class="exercise-card" onclick="startExercise('negatives')">
     <h3 class="exercise-title" id="exercise5Title">âŒ Forme Negative</h3>
     <p class="exercise-description">Padroneggia l'uso di ä¸ e æ²¡ per le negazioni</p><button class="start-btn">Inizia Esercizio</button>
    </div>
    <div class="exercise-card" onclick="startExercise('questions')">
     <h3 class="exercise-title" id="exercise6Title">â“ Formazione Domande</h3>
     <p class="exercise-description">Crea domande con å—, ä»€ä¹ˆ, è°, å“ªé‡Œ, å‡ </p><button class="start-btn">Inizia Esercizio</button>
    </div>
    <div class="exercise-card" onclick="startExercise('comparatives')">
     <h3 class="exercise-title" id="exercise7Title">âš–ï¸ Comparativi</h3>
     <p class="exercise-description">Usa æ¯” e altre strutture per fare paragoni</p><button class="start-btn">Inizia Esercizio</button>
    </div>
    <div class="exercise-card" onclick="startExercise('ba-construction')">
     <h3 class="exercise-title" id="exercise8Title">ğŸ”„ Costruzione æŠŠ</h3>
     <p class="exercise-description">Impara questa importante struttura grammaticale</p><button class="start-btn">Inizia Esercizio</button>
    </div>
    <div class="exercise-card" onclick="startExercise('directional')">
     <h3 class="exercise-title" id="exercise9Title">ğŸ§­ Complementi Direzionali</h3>
     <p class="exercise-description">Usa åˆ°, ä», åœ¨, å‘ per indicare movimento e posizione</p><button class="start-btn">Inizia Esercizio</button>
    </div>
    <div class="exercise-card" onclick="startExercise('adverbs')">
     <h3 class="exercise-title" id="exercise10Title">âš¡ Avverbi</h3>
     <p class="exercise-description">Impara å¾ˆ, å¤ª, éå¸¸, å·²ç», è¿˜, å°±, æ‰, éƒ½</p><button class="start-btn">Inizia Esercizio</button>
    </div>
   </main><!-- Area Esercizi -->
   <div id="exerciseArea" class="exercise-area">
    <div class="navigation-buttons"><button class="nav-btn" onclick="backToMenu()">â† Menu Principale</button>
     <div class="score-display">
      Domanda <span id="currentQuestion">1</span> di <span id="totalQuestions">10</span> | Punteggio: <span id="currentScore">0</span>
     </div><button class="nav-btn primary" id="nextBtn" onclick="nextQuestion()" disabled>Avanti â†’</button>
    </div>
    <div class="progress-bar">
     <div class="progress-fill" id="progressFill" style="width: 0%"></div>
    </div>
    <div id="questionContainer" class="question-card"><!-- Le domande verranno inserite qui dinamicamente -->
    </div>
    <div id="feedbackContainer"></div>
   </div><!-- Schermata Risultati Finali -->
   <div id="finalResults" class="exercise-area">
    <div class="final-score">
     <h2>ğŸ‰ Esercizio Completato!</h2>
     <p id="finalScoreText">Hai ottenuto 0/10 risposte corrette</p>
     <div class="navigation-buttons"><button class="nav-btn" onclick="backToMenu()">â† Menu Principale</button> <button class="nav-btn primary" onclick="restartExercise()">Ripeti Esercizio</button>
     </div>
    </div>
   </div>
  </div>
  <script>
        // Configurazione predefinita
        const defaultConfig = {
            main_title: "Esercizi di Grammatica Cinese",
            subtitle: "Impara la grammatica con esercizi interattivi e correzione automatica ğŸ“š",
            exercise1_title: "ğŸ“ Ordine delle Parole",
            exercise2_title: "ğŸ”¤ Particelle Grammaticali",
            exercise3_title: "â° Tempi Verbali",
            exercise4_title: "ğŸ“ Classificatori",
            exercise5_title: "âŒ Forme Negative",
            exercise6_title: "â“ Formazione Domande",
            exercise7_title: "âš–ï¸ Comparativi",
            exercise8_title: "ğŸ”„ Costruzione æŠŠ",
            exercise9_title: "ğŸ§­ Complementi Direzionali",
            exercise10_title: "âš¡ Avverbi"
        };

        // Dati degli esercizi
        const exercises = {
            'word-order': [
                {
                    question: "Riordina le parole per dire 'Io mangio riso':",
                    words: ['æˆ‘', 'åƒ', 'ç±³é¥­', 'å¾ˆ', 'å¥½'],
                    correct: ['æˆ‘', 'åƒ', 'ç±³é¥­'],
                    explanation: "In cinese l'ordine base Ã¨ Soggetto + Verbo + Oggetto (SVO), come in italiano."
                },
                {
                    question: "Riordina per dire 'Lui studia cinese':",
                    words: ['ä»–', 'å­¦ä¹ ', 'ä¸­æ–‡', 'æ¯å¤©', 'å¾ˆ'],
                    correct: ['ä»–', 'å­¦ä¹ ', 'ä¸­æ–‡'],
                    explanation: "La struttura SVO Ã¨ mantenuta: ä»– (lui) + å­¦ä¹  (studiare) + ä¸­æ–‡ (cinese)."
                },
                {
                    question: "Riordina per dire 'Noi andiamo a scuola':",
                    words: ['æˆ‘ä»¬', 'å»', 'å­¦æ ¡', 'ä»Šå¤©', 'ä¸'],
                    correct: ['æˆ‘ä»¬', 'å»', 'å­¦æ ¡'],
                    explanation: "æˆ‘ä»¬ (noi) + å» (andare) + å­¦æ ¡ (scuola). Il verbo di movimento precede il luogo."
                },
                {
                    question: "Riordina per dire 'Lei beve tÃ¨':",
                    words: ['å¥¹', 'å–', 'èŒ¶', 'å¾ˆ', 'çƒ­'],
                    correct: ['å¥¹', 'å–', 'èŒ¶'],
                    explanation: "Struttura semplice SVO: å¥¹ (lei) + å– (bere) + èŒ¶ (tÃ¨)."
                },
                {
                    question: "Riordina per dire 'Loro leggono libri':",
                    words: ['ä»–ä»¬', 'çœ‹', 'ä¹¦', 'æ¯å¤©', 'ä¸‰'],
                    correct: ['ä»–ä»¬', 'çœ‹', 'ä¹¦'],
                    explanation: "ä»–ä»¬ (loro) + çœ‹ (leggere/guardare) + ä¹¦ (libro/libri)."
                }
            ],
            'particles': [
                {
                    question: "Completa la frase: è¿™æ˜¯æˆ‘___ ä¹¦",
                    options: ['çš„', 'äº†', 'å—', 'å‘¢'],
                    correct: 'çš„',
                    explanation: "çš„ Ã¨ la particella possessiva. è¿™æ˜¯æˆ‘çš„ä¹¦ = 'Questo Ã¨ il mio libro'."
                },
                {
                    question: "Completa la domanda: ä½ å¥½___?",
                    options: ['çš„', 'äº†', 'å—', 'å‘¢'],
                    correct: 'å—',
                    explanation: "å— trasforma una frase in domanda sÃ¬/no. ä½ å¥½å—? = 'Come stai?'"
                },
                {
                    question: "Completa: æˆ‘åƒ___é¥­",
                    options: ['çš„', 'äº†', 'å—', 'å‘¢'],
                    correct: 'äº†',
                    explanation: "äº† indica un'azione completata. æˆ‘åƒäº†é¥­ = 'Ho mangiato (il riso)'."
                },
                {
                    question: "Completa: ä½ ___?",
                    options: ['çš„', 'äº†', 'å—', 'å‘¢'],
                    correct: 'å‘¢',
                    explanation: "å‘¢ si usa per domande informali o per chiedere 'e tu?'. ä½ å‘¢? = 'E tu?'"
                },
                {
                    question: "Completa: å¾ˆå¥½___æœ‹å‹",
                    options: ['çš„', 'äº†', 'å—', 'å‘¢'],
                    correct: 'çš„',
                    explanation: "çš„ collega aggettivi a sostantivi. å¾ˆå¥½çš„æœ‹å‹ = 'un buon amico'."
                }
            ],
            'verb-tenses': [
                {
                    question: "Scegli la forma corretta per 'Ieri ho mangiato':",
                    options: ['æˆ‘åƒ', 'æˆ‘åƒäº†', 'æˆ‘è¦åƒ', 'æˆ‘åœ¨åƒ'],
                    correct: 'æˆ‘åƒäº†',
                    explanation: "äº† indica un'azione completata nel passato. æˆ‘åƒäº† = 'Ho mangiato'."
                },
                {
                    question: "Scegli per 'Sto mangiando ora':",
                    options: ['æˆ‘åƒ', 'æˆ‘åƒäº†', 'æˆ‘è¦åƒ', 'æˆ‘åœ¨åƒ'],
                    correct: 'æˆ‘åœ¨åƒ',
                    explanation: "åœ¨ + verbo indica un'azione in corso. æˆ‘åœ¨åƒ = 'Sto mangiando'."
                },
                {
                    question: "Scegli per 'MangerÃ² domani':",
                    options: ['æˆ‘åƒ', 'æˆ‘åƒäº†', 'æˆ‘è¦åƒ', 'æˆ‘åœ¨åƒ'],
                    correct: 'æˆ‘è¦åƒ',
                    explanation: "è¦ + verbo indica intenzione futura. æˆ‘è¦åƒ = 'MangerÃ²/Voglio mangiare'."
                },
                {
                    question: "Scegli per 'Di solito mangio':",
                    options: ['æˆ‘åƒ', 'æˆ‘åƒäº†', 'æˆ‘è¦åƒ', 'æˆ‘åœ¨åƒ'],
                    correct: 'æˆ‘åƒ',
                    explanation: "La forma base del verbo indica azioni abituali. æˆ‘åƒ = 'Mangio (abitualmente)'."
                },
                {
                    question: "Scegli per 'Ho giÃ  studiato':",
                    options: ['æˆ‘å­¦ä¹ ', 'æˆ‘å­¦ä¹ äº†', 'æˆ‘è¦å­¦ä¹ ', 'æˆ‘åœ¨å­¦ä¹ '],
                    correct: 'æˆ‘å­¦ä¹ äº†',
                    explanation: "äº† indica completamento. æˆ‘å­¦ä¹ äº† = 'Ho studiato/Ho giÃ  studiato'."
                }
            ],
            'classifiers': [
                {
                    question: "Scegli il classificatore per 'tre libri':",
                    options: ['ä¸‰ä¸ªä¹¦', 'ä¸‰æœ¬ä¹¦', 'ä¸‰åªä¹¦', 'ä¸‰å¼ ä¹¦'],
                    correct: 'ä¸‰æœ¬ä¹¦',
                    explanation: "æœ¬ Ã¨ il classificatore per libri, riviste e oggetti rilegati. ä¸‰æœ¬ä¹¦ = 'tre libri'."
                },
                {
                    question: "Scegli il classificatore per 'due persone':",
                    options: ['ä¸¤ä¸ªäºº', 'ä¸¤æœ¬äºº', 'ä¸¤åªäºº', 'ä¸¤å¼ äºº'],
                    correct: 'ä¸¤ä¸ªäºº',
                    explanation: "ä¸ª Ã¨ il classificatore generale per persone e molti oggetti. ä¸¤ä¸ªäºº = 'due persone'."
                },
                {
                    question: "Scegli il classificatore per 'un gatto':",
                    options: ['ä¸€ä¸ªçŒ«', 'ä¸€æœ¬çŒ«', 'ä¸€åªçŒ«', 'ä¸€å¼ çŒ«'],
                    correct: 'ä¸€åªçŒ«',
                    explanation: "åª Ã¨ il classificatore per animali. ä¸€åªçŒ« = 'un gatto'."
                },
                {
                    question: "Scegli il classificatore per 'cinque fogli di carta':",
                    options: ['äº”ä¸ªçº¸', 'äº”æœ¬çº¸', 'äº”åªçº¸', 'äº”å¼ çº¸'],
                    correct: 'äº”å¼ çº¸',
                    explanation: "å¼  Ã¨ il classificatore per fogli, tavoli, letti e superfici piatte. äº”å¼ çº¸ = 'cinque fogli di carta'."
                },
                {
                    question: "Scegli il classificatore per 'una macchina':",
                    options: ['ä¸€ä¸ªè½¦', 'ä¸€è¾†è½¦', 'ä¸€åªè½¦', 'ä¸€å¼ è½¦'],
                    correct: 'ä¸€è¾†è½¦',
                    explanation: "è¾† Ã¨ il classificatore per veicoli. ä¸€è¾†è½¦ = 'una macchina/un veicolo'."
                }
            ],
            'negatives': [
                {
                    question: "Scegli la negazione corretta per 'Non mangio carne':",
                    options: ['æˆ‘ä¸åƒè‚‰', 'æˆ‘æ²¡åƒè‚‰', 'æˆ‘ä¸è¦åƒè‚‰', 'æˆ‘æ²¡æœ‰åƒè‚‰'],
                    correct: 'æˆ‘ä¸åƒè‚‰',
                    explanation: "ä¸ si usa per negare azioni abituali o stati. æˆ‘ä¸åƒè‚‰ = 'Non mangio carne (abitualmente)'."
                },
                {
                    question: "Scegli la negazione per 'Non ho mangiato':",
                    options: ['æˆ‘ä¸åƒäº†', 'æˆ‘æ²¡åƒ', 'æˆ‘ä¸è¦åƒ', 'æˆ‘ä¸åƒ'],
                    correct: 'æˆ‘æ²¡åƒ',
                    explanation: "æ²¡ si usa per negare azioni completate. æˆ‘æ²¡åƒ = 'Non ho mangiato'."
                },
                {
                    question: "Scegli la negazione per 'Non sono cinese':",
                    options: ['æˆ‘ä¸æ˜¯ä¸­å›½äºº', 'æˆ‘æ²¡æ˜¯ä¸­å›½äºº', 'æˆ‘ä¸è¦æ˜¯ä¸­å›½äºº', 'æˆ‘æ²¡æœ‰æ˜¯ä¸­å›½äºº'],
                    correct: 'æˆ‘ä¸æ˜¯ä¸­å›½äºº',
                    explanation: "ä¸ si usa con il verbo æ˜¯ (essere). æˆ‘ä¸æ˜¯ä¸­å›½äºº = 'Non sono cinese'."
                },
                {
                    question: "Scegli la negazione per 'Non ho soldi':",
                    options: ['æˆ‘ä¸æœ‰é’±', 'æˆ‘æ²¡æœ‰é’±', 'æˆ‘ä¸è¦é’±', 'æˆ‘æ²¡é’±'],
                    correct: 'æˆ‘æ²¡æœ‰é’±',
                    explanation: "æ²¡æœ‰ si usa per indicare mancanza o assenza. æˆ‘æ²¡æœ‰é’± = 'Non ho soldi'."
                },
                {
                    question: "Scegli la negazione per 'Non voglio andare':",
                    options: ['æˆ‘ä¸è¦å»', 'æˆ‘æ²¡è¦å»', 'æˆ‘ä¸å»', 'æˆ‘æ²¡å»'],
                    correct: 'æˆ‘ä¸è¦å»',
                    explanation: "ä¸è¦ si usa per negare volontÃ  o intenzione. æˆ‘ä¸è¦å» = 'Non voglio andare'."
                }
            ],
            'questions': [
                {
                    question: "Trasforma in domanda: ä½ æ˜¯å­¦ç”Ÿ (Tu sei studente)",
                    options: ['ä½ æ˜¯å­¦ç”Ÿå—ï¼Ÿ', 'ä½ æ˜¯ä»€ä¹ˆå­¦ç”Ÿï¼Ÿ', 'ä½ æ˜¯è°å­¦ç”Ÿï¼Ÿ', 'ä½ æ˜¯å“ªé‡Œå­¦ç”Ÿï¼Ÿ'],
                    correct: 'ä½ æ˜¯å­¦ç”Ÿå—ï¼Ÿ',
                    explanation: "å— trasforma una frase affermativa in domanda sÃ¬/no. ä½ æ˜¯å­¦ç”Ÿå—ï¼Ÿ = 'Sei studente?'"
                },
                {
                    question: "Chiedi 'Cosa fai?' usando ä»€ä¹ˆ:",
                    options: ['ä½ åšä»€ä¹ˆï¼Ÿ', 'ä½ ä»€ä¹ˆåšï¼Ÿ', 'ä»€ä¹ˆä½ åšï¼Ÿ', 'åšä»€ä¹ˆä½ ï¼Ÿ'],
                    correct: 'ä½ åšä»€ä¹ˆï¼Ÿ',
                    explanation: "ä»€ä¹ˆ significa 'cosa/che cosa'. ä½ åšä»€ä¹ˆï¼Ÿ = 'Cosa fai?'"
                },
                {
                    question: "Chiedi 'Chi Ã¨ lui?' usando è°:",
                    options: ['ä»–æ˜¯è°ï¼Ÿ', 'è°ä»–æ˜¯ï¼Ÿ', 'æ˜¯è°ä»–ï¼Ÿ', 'ä»–è°æ˜¯ï¼Ÿ'],
                    correct: 'ä»–æ˜¯è°ï¼Ÿ',
                    explanation: "è° significa 'chi'. ä»–æ˜¯è°ï¼Ÿ = 'Chi Ã¨ lui?'"
                },
                {
                    question: "Chiedi 'Dove vai?' usando å“ªé‡Œ:",
                    options: ['ä½ å»å“ªé‡Œï¼Ÿ', 'å“ªé‡Œä½ å»ï¼Ÿ', 'å»å“ªé‡Œä½ ï¼Ÿ', 'ä½ å“ªé‡Œå»ï¼Ÿ'],
                    correct: 'ä½ å»å“ªé‡Œï¼Ÿ',
                    explanation: "å“ªé‡Œ significa 'dove'. ä½ å»å“ªé‡Œï¼Ÿ = 'Dove vai?'"
                },
                {
                    question: "Chiedi 'Quanti anni hai?' usando å‡ :",
                    options: ['ä½ å‡ å²ï¼Ÿ', 'å‡ ä½ å²ï¼Ÿ', 'å²ä½ å‡ ï¼Ÿ', 'ä½ å²å‡ ï¼Ÿ'],
                    correct: 'ä½ å‡ å²ï¼Ÿ',
                    explanation: "å‡  si usa per chiedere 'quanti' (numeri piccoli). ä½ å‡ å²ï¼Ÿ = 'Quanti anni hai?'"
                }
            ],
            'comparatives': [
                {
                    question: "Traduci 'Lui Ã¨ piÃ¹ alto di me':",
                    options: ['ä»–æ¯”æˆ‘é«˜', 'ä»–æˆ‘æ¯”é«˜', 'æ¯”ä»–æˆ‘é«˜', 'æˆ‘æ¯”ä»–é«˜'],
                    correct: 'ä»–æ¯”æˆ‘é«˜',
                    explanation: "La struttura Ã¨ A + æ¯” + B + aggettivo. ä»–æ¯”æˆ‘é«˜ = 'Lui Ã¨ piÃ¹ alto di me'."
                },
                {
                    question: "Traduci 'Il cinese Ã¨ piÃ¹ difficile dell'inglese':",
                    options: ['ä¸­æ–‡æ¯”è‹±æ–‡éš¾', 'è‹±æ–‡æ¯”ä¸­æ–‡éš¾', 'ä¸­æ–‡è‹±æ–‡æ¯”éš¾', 'æ¯”ä¸­æ–‡è‹±æ–‡éš¾'],
                    correct: 'ä¸­æ–‡æ¯”è‹±æ–‡éš¾',
                    explanation: "ä¸­æ–‡æ¯”è‹±æ–‡éš¾ = 'Il cinese Ã¨ piÃ¹ difficile dell'inglese'. A + æ¯” + B + aggettivo."
                },
                {
                    question: "Traduci 'Oggi fa piÃ¹ caldo di ieri':",
                    options: ['ä»Šå¤©æ¯”æ˜¨å¤©çƒ­', 'æ˜¨å¤©æ¯”ä»Šå¤©çƒ­', 'ä»Šå¤©æ˜¨å¤©æ¯”çƒ­', 'æ¯”ä»Šå¤©æ˜¨å¤©çƒ­'],
                    correct: 'ä»Šå¤©æ¯”æ˜¨å¤©çƒ­',
                    explanation: "ä»Šå¤©æ¯”æ˜¨å¤©çƒ­ = 'Oggi fa piÃ¹ caldo di ieri'. Struttura: A + æ¯” + B + aggettivo."
                },
                {
                    question: "Traduci 'Lei Ã¨ bella quanto te':",
                    options: ['å¥¹è·Ÿä½ ä¸€æ ·æ¼‚äº®', 'å¥¹æ¯”ä½ æ¼‚äº®', 'ä½ æ¯”å¥¹æ¼‚äº®', 'å¥¹ä½ ä¸€æ ·æ¼‚äº®'],
                    correct: 'å¥¹è·Ÿä½ ä¸€æ ·æ¼‚äº®',
                    explanation: "è·Ÿ...ä¸€æ · indica uguaglianza. å¥¹è·Ÿä½ ä¸€æ ·æ¼‚äº® = 'Lei Ã¨ bella quanto te'."
                },
                {
                    question: "Traduci 'Questo libro Ã¨ il piÃ¹ interessante':",
                    options: ['è¿™æœ¬ä¹¦æœ€æœ‰è¶£', 'è¿™æœ¬ä¹¦æ¯”æœ‰è¶£', 'è¿™æœ¬ä¹¦å¾ˆæœ‰è¶£', 'è¿™æœ¬ä¹¦ä¸€æ ·æœ‰è¶£'],
                    correct: 'è¿™æœ¬ä¹¦æœ€æœ‰è¶£',
                    explanation: "æœ€ indica il superlativo. è¿™æœ¬ä¹¦æœ€æœ‰è¶£ = 'Questo libro Ã¨ il piÃ¹ interessante'."
                }
            ],
            'ba-construction': [
                {
                    question: "Trasforma usando æŠŠ: æˆ‘åƒäº†è‹¹æœ (Ho mangiato la mela)",
                    options: ['æˆ‘æŠŠè‹¹æœåƒäº†', 'æˆ‘åƒæŠŠè‹¹æœäº†', 'æŠŠæˆ‘è‹¹æœåƒäº†', 'æˆ‘è‹¹æœæŠŠåƒäº†'],
                    correct: 'æˆ‘æŠŠè‹¹æœåƒäº†',
                    explanation: "La costruzione æŠŠ Ã¨: Soggetto + æŠŠ + Oggetto + Verbo + Risultato. æˆ‘æŠŠè‹¹æœåƒäº† = 'Ho mangiato la mela'."
                },
                {
                    question: "Trasforma usando æŠŠ: ä»–å…³äº†é—¨ (Ha chiuso la porta)",
                    options: ['ä»–æŠŠé—¨å…³äº†', 'ä»–å…³æŠŠé—¨äº†', 'æŠŠä»–é—¨å…³äº†', 'ä»–é—¨æŠŠå…³äº†'],
                    correct: 'ä»–æŠŠé—¨å…³äº†',
                    explanation: "ä»–æŠŠé—¨å…³äº† = 'Ha chiuso la porta'. La costruzione æŠŠ enfatizza l'effetto dell'azione sull'oggetto."
                },
                {
                    question: "Trasforma usando æŠŠ: æˆ‘å†™å®Œäº†ä½œä¸š (Ho finito i compiti)",
                    options: ['æˆ‘æŠŠä½œä¸šå†™å®Œäº†', 'æˆ‘å†™æŠŠä½œä¸šå®Œäº†', 'æŠŠæˆ‘ä½œä¸šå†™å®Œäº†', 'æˆ‘ä½œä¸šæŠŠå†™å®Œäº†'],
                    correct: 'æˆ‘æŠŠä½œä¸šå†™å®Œäº†',
                    explanation: "æˆ‘æŠŠä½œä¸šå†™å®Œäº† = 'Ho finito i compiti'. æŠŠ + oggetto + verbo + complemento di risultato."
                },
                {
                    question: "Trasforma usando æŠŠ: å¥¹æ‰“ç ´äº†æ¯å­ (Ha rotto il bicchiere)",
                    options: ['å¥¹æŠŠæ¯å­æ‰“ç ´äº†', 'å¥¹æ‰“æŠŠæ¯å­ç ´äº†', 'æŠŠå¥¹æ¯å­æ‰“ç ´äº†', 'å¥¹æ¯å­æŠŠæ‰“ç ´äº†'],
                    correct: 'å¥¹æŠŠæ¯å­æ‰“ç ´äº†',
                    explanation: "å¥¹æŠŠæ¯å­æ‰“ç ´äº† = 'Ha rotto il bicchiere'. La costruzione æŠŠ mostra come l'azione cambia l'oggetto."
                },
                {
                    question: "Trasforma usando æŠŠ: è€å¸ˆæ•™ä¼šäº†å­¦ç”Ÿ (Il maestro ha insegnato agli studenti)",
                    options: ['è€å¸ˆæŠŠå­¦ç”Ÿæ•™ä¼šäº†', 'è€å¸ˆæ•™æŠŠå­¦ç”Ÿä¼šäº†', 'æŠŠè€å¸ˆå­¦ç”Ÿæ•™ä¼šäº†', 'è€å¸ˆå­¦ç”ŸæŠŠæ•™ä¼šäº†'],
                    correct: 'è€å¸ˆæŠŠå­¦ç”Ÿæ•™ä¼šäº†',
                    explanation: "è€å¸ˆæŠŠå­¦ç”Ÿæ•™ä¼šäº† = 'Il maestro ha insegnato (con successo) agli studenti'. æŠŠ enfatizza il risultato."
                }
            ],
            'directional': [
                {
                    question: "Scegli il complemento per 'Vado a casa':",
                    options: ['æˆ‘å›åˆ°å®¶', 'æˆ‘å›ä»å®¶', 'æˆ‘å›åœ¨å®¶', 'æˆ‘å›å‘å®¶'],
                    correct: 'æˆ‘å›åˆ°å®¶',
                    explanation: "åˆ° indica movimento verso una destinazione. æˆ‘å›åˆ°å®¶ = 'Vado/Torno a casa'."
                },
                {
                    question: "Scegli il complemento per 'Vengo da Pechino':",
                    options: ['æˆ‘åˆ°åŒ—äº¬æ¥', 'æˆ‘ä»åŒ—äº¬æ¥', 'æˆ‘åœ¨åŒ—äº¬æ¥', 'æˆ‘å‘åŒ—äº¬æ¥'],
                    correct: 'æˆ‘ä»åŒ—äº¬æ¥',
                    explanation: "ä» indica provenienza, origine. æˆ‘ä»åŒ—äº¬æ¥ = 'Vengo da Pechino'."
                },
                {
                    question: "Scegli il complemento per 'Sono a scuola':",
                    options: ['æˆ‘åˆ°å­¦æ ¡', 'æˆ‘ä»å­¦æ ¡', 'æˆ‘åœ¨å­¦æ ¡', 'æˆ‘å‘å­¦æ ¡'],
                    correct: 'æˆ‘åœ¨å­¦æ ¡',
                    explanation: "åœ¨ indica posizione, ubicazione. æˆ‘åœ¨å­¦æ ¡ = 'Sono a scuola'."
                },
                {
                    question: "Scegli il complemento per 'Cammino verso il parco':",
                    options: ['æˆ‘åˆ°å…¬å›­èµ°', 'æˆ‘ä»å…¬å›­èµ°', 'æˆ‘åœ¨å…¬å›­èµ°', 'æˆ‘å‘å…¬å›­èµ°'],
                    correct: 'æˆ‘å‘å…¬å›­èµ°',
                    explanation: "å‘ indica direzione verso qualcosa. æˆ‘å‘å…¬å›­èµ° = 'Cammino verso il parco'."
                },
                {
                    question: "Scegli il complemento per 'Arrivo alla stazione':",
                    options: ['æˆ‘åˆ°è½¦ç«™äº†', 'æˆ‘ä»è½¦ç«™äº†', 'æˆ‘åœ¨è½¦ç«™äº†', 'æˆ‘å‘è½¦ç«™äº†'],
                    correct: 'æˆ‘åˆ°è½¦ç«™äº†',
                    explanation: "åˆ° + äº† indica arrivo completato. æˆ‘åˆ°è½¦ç«™äº† = 'Sono arrivato alla stazione'."
                }
            ],
            'adverbs': [
                {
                    question: "Scegli l'avverbio corretto per 'Ãˆ molto bello':",
                    options: ['ä»–å¾ˆæ¼‚äº®', 'ä»–å¤ªæ¼‚äº®', 'ä»–éå¸¸æ¼‚äº®', 'ä»–éƒ½æ¼‚äº®'],
                    correct: 'ä»–å¾ˆæ¼‚äº®',
                    explanation: "å¾ˆ Ã¨ l'avverbio base per 'molto'. ä»–å¾ˆæ¼‚äº® = 'Ãˆ molto bello'. å¾ˆ Ã¨ neutro e si usa sempre con aggettivi."
                },
                {
                    question: "Scegli l'avverbio per 'Ãˆ troppo caro':",
                    options: ['è¿™ä¸ªå¾ˆè´µ', 'è¿™ä¸ªå¤ªè´µäº†', 'è¿™ä¸ªéå¸¸è´µ', 'è¿™ä¸ªéƒ½è´µ'],
                    correct: 'è¿™ä¸ªå¤ªè´µäº†',
                    explanation: "å¤ª significa 'troppo' (eccessivo). è¿™ä¸ªå¤ªè´µäº† = 'Questo Ã¨ troppo caro'. å¤ª implica un eccesso negativo."
                },
                {
                    question: "Scegli l'avverbio per 'Ãˆ estremamente interessante':",
                    options: ['å¾ˆæœ‰è¶£', 'å¤ªæœ‰è¶£', 'éå¸¸æœ‰è¶£', 'éƒ½æœ‰è¶£'],
                    correct: 'éå¸¸æœ‰è¶£',
                    explanation: "éå¸¸ significa 'estremamente/molto' (piÃ¹ forte di å¾ˆ). éå¸¸æœ‰è¶£ = 'Ãˆ estremamente interessante'."
                },
                {
                    question: "Scegli l'avverbio per 'Ho giÃ  mangiato':",
                    options: ['æˆ‘å¾ˆåƒäº†', 'æˆ‘å¤ªåƒäº†', 'æˆ‘å·²ç»åƒäº†', 'æˆ‘éƒ½åƒäº†'],
                    correct: 'æˆ‘å·²ç»åƒäº†',
                    explanation: "å·²ç» significa 'giÃ /ormai'. æˆ‘å·²ç»åƒäº† = 'Ho giÃ  mangiato'. Si usa per azioni completate."
                },
                {
                    question: "Scegli l'avverbio per 'Ancora non ho finito':",
                    options: ['æˆ‘å¾ˆæ²¡å®Œæˆ', 'æˆ‘è¿˜æ²¡å®Œæˆ', 'æˆ‘å·²ç»æ²¡å®Œæˆ', 'æˆ‘éƒ½æ²¡å®Œæˆ'],
                    correct: 'æˆ‘è¿˜æ²¡å®Œæˆ',
                    explanation: "è¿˜ + æ²¡ significa 'ancora non'. æˆ‘è¿˜æ²¡å®Œæˆ = 'Ancora non ho finito'. è¿˜ indica continuitÃ ."
                },
                {
                    question: "Scegli l'avverbio per 'Tutti sono venuti':",
                    options: ['å¾ˆæ¥äº†', 'å¤ªæ¥äº†', 'å·²ç»æ¥äº†', 'éƒ½æ¥äº†'],
                    correct: 'éƒ½æ¥äº†',
                    explanation: "éƒ½ significa 'tutti/tutto'. éƒ½æ¥äº† = 'Sono venuti tutti'. éƒ½ indica totalitÃ  o inclusivitÃ ."
                },
                {
                    question: "Scegli per 'ArriverÃ² alle 8 in punto' (enfasi sulla puntualitÃ ):",
                    options: ['æˆ‘å¾ˆå…«ç‚¹åˆ°', 'æˆ‘å°±å…«ç‚¹åˆ°', 'æˆ‘æ‰å…«ç‚¹åˆ°', 'æˆ‘éƒ½å…«ç‚¹åˆ°'],
                    correct: 'æˆ‘å°±å…«ç‚¹åˆ°',
                    explanation: "å°± enfatizza puntualitÃ  o precisione. æˆ‘å°±å…«ç‚¹åˆ° = 'ArriverÃ² proprio alle 8'. å°± = 'proprio/esattamente'."
                },
                {
                    question: "Scegli per 'ArriverÃ² solo alle 8' (piÃ¹ tardi del previsto):",
                    options: ['æˆ‘å¾ˆå…«ç‚¹åˆ°', 'æˆ‘å°±å…«ç‚¹åˆ°', 'æˆ‘æ‰å…«ç‚¹åˆ°', 'æˆ‘éƒ½å…«ç‚¹åˆ°'],
                    correct: 'æˆ‘æ‰å…«ç‚¹åˆ°',
                    explanation: "æ‰ indica 'solo/soltanto' (piÃ¹ tardi del previsto). æˆ‘æ‰å…«ç‚¹åˆ° = 'ArriverÃ² solo alle 8' (tardi)."
                }
            ]
        };

        // Variabili di stato
        let currentExerciseType = '';
        let currentQuestionIndex = 0;
        let currentScore = 0;
        let currentExerciseData = [];
        let userAnswer = null;
        let draggedWords = [];

        // Funzioni principali
        function startExercise(type) {
            currentExerciseType = type;
            currentQuestionIndex = 0;
            currentScore = 0;
            currentExerciseData = [...exercises[type]];
            userAnswer = null;
            draggedWords = [];

            document.getElementById('exerciseSelector').style.display = 'none';
            document.getElementById('exerciseArea').style.display = 'block';
            document.getElementById('finalResults').style.display = 'none';

            updateProgress();
            showQuestion();
        }

        function showQuestion() {
            const question = currentExerciseData[currentQuestionIndex];
            const container = document.getElementById('questionContainer');
            const feedbackContainer = document.getElementById('feedbackContainer');
            
            feedbackContainer.innerHTML = '';
            document.getElementById('nextBtn').disabled = true;
            userAnswer = null;
            draggedWords = [];

            if (currentExerciseType === 'word-order') {
                container.innerHTML = `
                    <div class="question-text">${question.question}</div>
                    <div class="drag-area" id="dropArea" ondrop="drop(event)" ondragover="allowDrop(event)">
                        <span style="color: #6c757d; font-style: italic;">Trascina qui le parole nell'ordine corretto...</span>
                    </div>
                    <div class="word-bank" id="wordBank">
                        ${question.words.map(word => 
                            `<span class="word-chip" draggable="true" ondragstart="drag(event, '${word}')">${word}</span>`
                        ).join('')}
                    </div>
                `;
            } else if (currentExerciseType === 'particles') {
                container.innerHTML = `
                    <div class="question-text">${question.question}</div>
                    <div class="chinese-text">${question.question.replace('___', '___')}</div>
                    <div class="options-grid">
                        ${question.options.map(option => 
                            `<button class="option-btn" onclick="selectOption('${option}')">${option}</button>`
                        ).join('')}
                    </div>
                `;
            } else {
                container.innerHTML = `
                    <div class="question-text">${question.question}</div>
                    <div class="options-grid">
                        ${question.options.map(option => 
                            `<button class="option-btn" onclick="selectOption('${option}')">${option}</button>`
                        ).join('')}
                    </div>
                `;
            }

            updateQuestionCounter();
        }

        function selectOption(option) {
            userAnswer = option;
            
            // Rimuovi selezione precedente
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            // Seleziona opzione corrente
            event.target.classList.add('selected');
            
            checkAnswer();
        }

        function drag(event, word) {
            event.dataTransfer.setData("text", word);
        }

        function allowDrop(event) {
            event.preventDefault();
            event.target.classList.add('drag-over');
        }

        function drop(event) {
            event.preventDefault();
            event.target.classList.remove('drag-over');
            
            const word = event.dataTransfer.getData("text");
            if (word && !draggedWords.includes(word)) {
                draggedWords.push(word);
                updateDropArea();
                
                // Nascondi la parola dalla word bank
                const wordChips = document.querySelectorAll('#wordBank .word-chip');
                wordChips.forEach(chip => {
                    if (chip.textContent === word && !chip.style.display) {
                        chip.style.display = 'none';
                        return;
                    }
                });
                
                // Controlla se abbiamo abbastanza parole
                const question = currentExerciseData[currentQuestionIndex];
                if (draggedWords.length >= question.correct.length) {
                    userAnswer = draggedWords.slice(0, question.correct.length);
                    checkAnswer();
                }
            }
        }

        function updateDropArea() {
            const dropArea = document.getElementById('dropArea');
            if (draggedWords.length === 0) {
                dropArea.innerHTML = '<span style="color: #6c757d; font-style: italic;">Trascina qui le parole nell\'ordine corretto...</span>';
            } else {
                dropArea.innerHTML = draggedWords.map((word, index) => 
                    `<span class="word-chip" onclick="removeWord(${index})">${word}</span>`
                ).join('');
            }
        }

        function removeWord(index) {
            const removedWord = draggedWords[index];
            draggedWords.splice(index, 1);
            updateDropArea();
            
            // Rimetti la parola nella word bank
            const wordChips = document.querySelectorAll('#wordBank .word-chip');
            wordChips.forEach(chip => {
                if (chip.textContent === removedWord && chip.style.display === 'none') {
                    chip.style.display = 'inline-block';
                    return;
                }
            });
        }

        function checkAnswer() {
            const question = currentExerciseData[currentQuestionIndex];
            const feedbackContainer = document.getElementById('feedbackContainer');
            let isCorrect = false;

            if (currentExerciseType === 'word-order') {
                isCorrect = JSON.stringify(userAnswer) === JSON.stringify(question.correct);
            } else {
                isCorrect = userAnswer === question.correct;
            }

            if (isCorrect) {
                currentScore++;
                feedbackContainer.innerHTML = `
                    <div class="feedback correct">
                        âœ… <strong>Corretto!</strong> Ottimo lavoro!
                        <div class="explanation">${question.explanation}</div>
                    </div>
                `;
                
                // Evidenzia risposta corretta
                if (currentExerciseType !== 'word-order') {
                    document.querySelectorAll('.option-btn').forEach(btn => {
                        if (btn.textContent === question.correct) {
                            btn.classList.add('correct');
                        }
                    });
                }
            } else {
                feedbackContainer.innerHTML = `
                    <div class="feedback wrong">
                        âŒ <strong>Non corretto.</strong> La risposta giusta Ã¨: <strong>${
                            currentExerciseType === 'word-order' ? 
                            question.correct.join(' ') : 
                            question.correct
                        }</strong>
                        <div class="explanation">${question.explanation}</div>
                    </div>
                `;
                
                // Evidenzia risposte
                if (currentExerciseType !== 'word-order') {
                    document.querySelectorAll('.option-btn').forEach(btn => {
                        if (btn.textContent === question.correct) {
                            btn.classList.add('correct');
                        } else if (btn.textContent === userAnswer) {
                            btn.classList.add('wrong');
                        }
                    });
                }
            }

            // Disabilita interazioni
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.disabled = true;
            });

            document.getElementById('nextBtn').disabled = false;
            updateScore();
        }

        function nextQuestion() {
            currentQuestionIndex++;
            
            if (currentQuestionIndex >= currentExerciseData.length) {
                showFinalResults();
            } else {
                updateProgress();
                showQuestion();
            }
        }

        function updateProgress() {
            const progress = ((currentQuestionIndex) / currentExerciseData.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function updateQuestionCounter() {
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            document.getElementById('totalQuestions').textContent = currentExerciseData.length;
        }

        function updateScore() {
            document.getElementById('currentScore').textContent = currentScore;
        }

        function showFinalResults() {
            document.getElementById('exerciseArea').style.display = 'none';
            document.getElementById('finalResults').style.display = 'block';
            
            const percentage = Math.round((currentScore / currentExerciseData.length) * 100);
            let message = '';
            
            if (percentage >= 90) {
                message = `Eccellente! ${currentScore}/${currentExerciseData.length} (${percentage}%) - Hai una padronanza ottima della grammatica! ğŸŒŸ`;
            } else if (percentage >= 70) {
                message = `Molto bene! ${currentScore}/${currentExerciseData.length} (${percentage}%) - Continua cosÃ¬! ğŸ‘`;
            } else if (percentage >= 50) {
                message = `Buon lavoro! ${currentScore}/${currentExerciseData.length} (${percentage}%) - Con un po' di pratica migliorerai! ğŸ’ª`;
            } else {
                message = `${currentScore}/${currentExerciseData.length} (${percentage}%) - Non scoraggiarti, la grammatica cinese richiede tempo! ğŸ“š`;
            }
            
            document.getElementById('finalScoreText').textContent = message;
        }

        function backToMenu() {
            document.getElementById('exerciseSelector').style.display = 'grid';
            document.getElementById('exerciseArea').style.display = 'none';
            document.getElementById('finalResults').style.display = 'none';
        }

        function restartExercise() {
            startExercise(currentExerciseType);
        }

        // Inizializzazione SDK
        async function onConfigChange(config) {
            document.getElementById('mainTitle').textContent = config.main_title || defaultConfig.main_title;
            document.getElementById('subtitle').textContent = config.subtitle || defaultConfig.subtitle;
            document.getElementById('exercise1Title').textContent = config.exercise1_title || defaultConfig.exercise1_title;
            document.getElementById('exercise2Title').textContent = config.exercise2_title || defaultConfig.exercise2_title;
            document.getElementById('exercise3Title').textContent = config.exercise3_title || defaultConfig.exercise3_title;
            document.getElementById('exercise4Title').textContent = config.exercise4_title || defaultConfig.exercise4_title;
            document.getElementById('exercise5Title').textContent = config.exercise5_title || defaultConfig.exercise5_title;
            document.getElementById('exercise6Title').textContent = config.exercise6_title || defaultConfig.exercise6_title;
            document.getElementById('exercise7Title').textContent = config.exercise7_title || defaultConfig.exercise7_title;
            document.getElementById('exercise8Title').textContent = config.exercise8_title || defaultConfig.exercise8_title;
            document.getElementById('exercise9Title').textContent = config.exercise9_title || defaultConfig.exercise9_title;
            document.getElementById('exercise10Title').textContent = config.exercise10_title || defaultConfig.exercise10_title;
        }

        function mapToCapabilities(config) {
            return {
                recolorables: [],
                borderables: [],
                fontEditable: undefined,
                fontSizeable: undefined
            };
        }

        function mapToEditPanelValues(config) {
            return new Map([
                ["main_title", config.main_title || defaultConfig.main_title],
                ["subtitle", config.subtitle || defaultConfig.subtitle],
                ["exercise1_title", config.exercise1_title || defaultConfig.exercise1_title],
                ["exercise2_title", config.exercise2_title || defaultConfig.exercise2_title],
                ["exercise3_title", config.exercise3_title || defaultConfig.exercise3_title],
                ["exercise4_title", config.exercise4_title || defaultConfig.exercise4_title],
                ["exercise5_title", config.exercise5_title || defaultConfig.exercise5_title],
                ["exercise6_title", config.exercise6_title || defaultConfig.exercise6_title],
                ["exercise7_title", config.exercise7_title || defaultConfig.exercise7_title],
                ["exercise8_title", config.exercise8_title || defaultConfig.exercise8_title],
                ["exercise9_title", config.exercise9_title || defaultConfig.exercise9_title],
                ["exercise10_title", config.exercise10_title || defaultConfig.exercise10_title]
            ]);
        }

        // Inizializza l'SDK quando disponibile
        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig,
                onConfigChange,
                mapToCapabilities,
                mapToEditPanelValues
            });
        }
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9959351bd2a1ee50',t:'MTc2MTY0MTY1NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>