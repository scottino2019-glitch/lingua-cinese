<!doctype html>
<html lang="it" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Esercizi Interattivi di Cinese</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        .chinese-char {
            font-family: 'SimSun', 'Microsoft YaHei', serif;
        }
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .correct-answer {
            animation: correctPulse 0.5s ease-in-out;
        }
        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="h-full bg-gradient-to-br from-red-50 to-yellow-50 font-sans">
  <div class="min-h-full p-4">
   <div class="max-w-4xl mx-auto"><!-- Header -->
    <header class="text-center mb-8">
     <h1 id="app-title" class="text-4xl font-bold text-red-700 mb-2 chinese-char">Ê±âËØ≠ÁªÉ‰π†</h1>
     <p id="welcome-message" class="text-lg text-gray-600">Scegli un tipo di esercizio per iniziare</p>
    </header><!-- Progress Bar -->
    <div class="bg-white rounded-lg shadow-md p-4 mb-6">
     <div class="flex justify-between items-center mb-2"><span id="progress-label" class="text-sm font-medium text-gray-700">Progresso</span> <span id="progress-text" class="text-sm text-gray-500">0/0 completati</span>
     </div>
     <div class="w-full bg-gray-200 rounded-full h-2">
      <div id="progress-bar" class="bg-red-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
     </div>
    </div><!-- Exercise Type Selection -->
    <div id="exercise-selection" class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"><button onclick="startExercise('characters')" class="bg-white hover:bg-red-50 border-2 border-red-200 hover:border-red-400 rounded-lg p-6 text-center transition-all duration-200">
      <div class="text-3xl mb-2 chinese-char">
       Ê±âÂ≠ó
      </div><h3 class="text-lg font-semibold text-gray-800 mb-1">Caratteri</h3><p class="text-sm text-gray-600">Riconosci i caratteri cinesi</p></button> <button onclick="startExercise('pinyin')" class="bg-white hover:bg-yellow-50 border-2 border-yellow-200 hover:border-yellow-400 rounded-lg p-6 text-center transition-all duration-200">
      <div class="text-3xl mb-2">
       üó£Ô∏è
      </div><h3 class="text-lg font-semibold text-gray-800 mb-1">Pinyin</h3><p class="text-sm text-gray-600">Pronuncia e toni</p></button> <button onclick="startExercise('translation')" class="bg-white hover:bg-blue-50 border-2 border-blue-200 hover:border-blue-400 rounded-lg p-6 text-center transition-all duration-200">
      <div class="text-3xl mb-2">
       üìñ
      </div><h3 class="text-lg font-semibold text-gray-800 mb-1">Traduzione</h3><p class="text-sm text-gray-600">Significato delle parole</p></button>
    </div><!-- Exercise Container -->
    <div id="exercise-container" class="hidden">
     <div class="bg-white rounded-lg shadow-lg p-6">
      <div class="flex justify-between items-center mb-4">
       <h2 id="exercise-title" class="text-xl font-bold text-gray-800"></h2><button onclick="backToSelection()" class="text-gray-500 hover:text-gray-700 text-sm">‚Üê Torna alla selezione</button>
      </div>
      <div id="exercise-content" class="text-center"><!-- Exercise content will be inserted here -->
      </div>
      <div id="exercise-feedback" class="mt-4 text-center hidden"><!-- Feedback will be shown here -->
      </div>
      <div class="flex justify-center mt-6"><button id="next-exercise-btn" onclick="nextExercise()" class="hidden bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg transition-colors duration-200"> Prossimo Esercizio </button>
      </div>
     </div>
    </div><!-- Statistics -->
    <div id="stats-container" class="mt-6 bg-white rounded-lg shadow-md p-4">
     <h3 class="text-lg font-semibold text-gray-800 mb-3">Statistiche</h3>
     <div class="grid grid-cols-3 gap-4 text-center">
      <div>
       <div id="total-exercises" class="text-2xl font-bold text-blue-600">
        0
       </div>
       <div class="text-sm text-gray-600">
        Totale
       </div>
      </div>
      <div>
       <div id="correct-exercises" class="text-2xl font-bold text-green-600">
        0
       </div>
       <div class="text-sm text-gray-600">
        Corretti
       </div>
      </div>
      <div>
       <div id="accuracy-percentage" class="text-2xl font-bold text-purple-600">
        0%
       </div>
       <div class="text-sm text-gray-600">
        Precisione
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
        // Chinese vocabulary database
        const chineseVocabulary = [
            { character: '‰Ω†Â•Ω', pinyin: 'n«ê h«éo', translation: 'ciao', type: 'greeting' },
            { character: 'Ë∞¢Ë∞¢', pinyin: 'xi√® xi√®', translation: 'grazie', type: 'courtesy' },
            { character: 'Ê∞¥', pinyin: 'shu«ê', translation: 'acqua', type: 'noun' },
            { character: 'ÂêÉ', pinyin: 'chƒ´', translation: 'mangiare', type: 'verb' },
            { character: 'Â≠¶‰π†', pinyin: 'xu√© x√≠', translation: 'studiare', type: 'verb' },
            { character: 'ÊúãÂèã', pinyin: 'p√©ng y«íu', translation: 'amico', type: 'noun' },
            { character: 'ÂÆ∂', pinyin: 'jiƒÅ', translation: 'casa', type: 'noun' },
            { character: 'Áà±', pinyin: '√†i', translation: 'amare', type: 'verb' },
            { character: '‰π¶', pinyin: 'sh≈´', translation: 'libro', type: 'noun' },
            { character: 'Â≠¶Ê†°', pinyin: 'xu√© xi√†o', translation: 'scuola', type: 'noun' },
            { character: 'ËÄÅÂ∏à', pinyin: 'l«éo shƒ´', translation: 'insegnante', type: 'noun' },
            { character: 'Â≠¶Áîü', pinyin: 'xu√© shƒìng', translation: 'studente', type: 'noun' },
            { character: '‰∏≠ÂõΩ', pinyin: 'zh≈çng gu√≥', translation: 'Cina', type: 'noun' },
            { character: 'Êó∂Èó¥', pinyin: 'sh√≠ jiƒÅn', translation: 'tempo', type: 'noun' },
            { character: 'Â∑•‰Ωú', pinyin: 'g≈çng zu√≤', translation: 'lavoro', type: 'noun' }
        ];

        let currentExerciseType = '';
        let currentExercise = null;
        let exerciseHistory = [];
        let stats = { total: 0, correct: 0 };

        // SDK Configuration
        const defaultConfig = {
            app_title: 'Esercizi Interattivi di Cinese',
            welcome_message: 'Scegli un tipo di esercizio per iniziare',
            progress_label: 'Progresso',
            primary_color: '#dc2626',
            surface_color: '#ffffff',
            text_color: '#374151',
            accent_color: '#fbbf24',
            success_color: '#059669'
        };

        let config = { ...defaultConfig };

        // Data handler for SDK
        const dataHandler = {
            onDataChanged(data) {
                exerciseHistory = data;
                updateStats();
                updateProgress();
            }
        };

        // Initialize SDKs
        async function initializeApp() {
            // Initialize Data SDK
            const dataResult = await window.dataSdk.init(dataHandler);
            if (!dataResult.isOk) {
                console.error('Failed to initialize data SDK');
            }

            // Initialize Element SDK
            if (window.elementSdk) {
                await window.elementSdk.init({
                    defaultConfig,
                    onConfigChange: async (newConfig) => {
                        config = { ...newConfig };
                        updateUIFromConfig();
                    },
                    mapToCapabilities: (config) => ({
                        recolorables: [
                            {
                                get: () => config.primary_color || defaultConfig.primary_color,
                                set: (value) => {
                                    config.primary_color = value;
                                    window.elementSdk.setConfig({ primary_color: value });
                                }
                            },
                            {
                                get: () => config.surface_color || defaultConfig.surface_color,
                                set: (value) => {
                                    config.surface_color = value;
                                    window.elementSdk.setConfig({ surface_color: value });
                                }
                            },
                            {
                                get: () => config.text_color || defaultConfig.text_color,
                                set: (value) => {
                                    config.text_color = value;
                                    window.elementSdk.setConfig({ text_color: value });
                                }
                            },
                            {
                                get: () => config.accent_color || defaultConfig.accent_color,
                                set: (value) => {
                                    config.accent_color = value;
                                    window.elementSdk.setConfig({ accent_color: value });
                                }
                            },
                            {
                                get: () => config.success_color || defaultConfig.success_color,
                                set: (value) => {
                                    config.success_color = value;
                                    window.elementSdk.setConfig({ success_color: value });
                                }
                            }
                        ],
                        borderables: [],
                        fontEditable: undefined,
                        fontSizeable: undefined
                    }),
                    mapToEditPanelValues: (config) => new Map([
                        ['app_title', config.app_title || defaultConfig.app_title],
                        ['welcome_message', config.welcome_message || defaultConfig.welcome_message],
                        ['progress_label', config.progress_label || defaultConfig.progress_label]
                    ])
                });
            }

            updateUIFromConfig();
        }

        function updateUIFromConfig() {
            document.getElementById('app-title').textContent = config.app_title || defaultConfig.app_title;
            document.getElementById('welcome-message').textContent = config.welcome_message || defaultConfig.welcome_message;
            document.getElementById('progress-label').textContent = config.progress_label || defaultConfig.progress_label;

            // Apply colors
            const primaryColor = config.primary_color || defaultConfig.primary_color;
            const surfaceColor = config.surface_color || defaultConfig.surface_color;
            const textColor = config.text_color || defaultConfig.text_color;
            const accentColor = config.accent_color || defaultConfig.accent_color;
            const successColor = config.success_color || defaultConfig.success_color;

            document.querySelector('h1').style.color = primaryColor;
            document.getElementById('progress-bar').style.backgroundColor = primaryColor;
            
            // Update surface colors
            document.querySelectorAll('.bg-white').forEach(el => {
                el.style.backgroundColor = surfaceColor;
            });

            // Update text colors
            document.querySelectorAll('.text-gray-800, .text-gray-700, .text-gray-600').forEach(el => {
                el.style.color = textColor;
            });
        }

        function startExercise(type) {
            currentExerciseType = type;
            document.getElementById('exercise-selection').classList.add('hidden');
            document.getElementById('exercise-container').classList.remove('hidden');
            
            const titles = {
                'characters': 'Riconoscimento Caratteri',
                'pinyin': 'Esercizi Pinyin',
                'translation': 'Traduzione'
            };
            
            document.getElementById('exercise-title').textContent = titles[type];
            generateExercise();
        }

        function generateExercise() {
            const word = chineseVocabulary[Math.floor(Math.random() * chineseVocabulary.length)];
            currentExercise = { ...word, id: Date.now().toString() };
            
            const content = document.getElementById('exercise-content');
            content.innerHTML = '';
            
            if (currentExerciseType === 'characters') {
                generateCharacterExercise(word, content);
            } else if (currentExerciseType === 'pinyin') {
                generatePinyinExercise(word, content);
            } else if (currentExerciseType === 'translation') {
                generateTranslationExercise(word, content);
            }
            
            document.getElementById('exercise-feedback').classList.add('hidden');
            document.getElementById('next-exercise-btn').classList.add('hidden');
        }

        function generateCharacterExercise(word, content) {
            const options = getRandomOptions(word.character, 'character');
            
            content.innerHTML = `
                <div class="mb-6">
                    <p class="text-lg mb-4">Quale carattere significa "${word.translation}"?</p>
                    <div class="grid grid-cols-2 gap-4">
                        ${options.map(option => `
                            <button onclick="checkAnswer('${option}', '${word.character}')" 
                                    class="bg-gray-100 hover:bg-gray-200 border-2 border-gray-300 rounded-lg p-4 text-2xl chinese-char transition-all duration-200">
                                ${option}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function generatePinyinExercise(word, content) {
            const options = getRandomOptions(word.pinyin, 'pinyin');
            
            content.innerHTML = `
                <div class="mb-6">
                    <p class="text-lg mb-2">Come si pronuncia questo carattere?</p>
                    <div class="text-4xl chinese-char mb-4">${word.character}</div>
                    <div class="grid grid-cols-2 gap-4">
                        ${options.map(option => `
                            <button onclick="checkAnswer('${option}', '${word.pinyin}')" 
                                    class="bg-gray-100 hover:bg-gray-200 border-2 border-gray-300 rounded-lg p-4 text-lg transition-all duration-200">
                                ${option}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function generateTranslationExercise(word, content) {
            const options = getRandomOptions(word.translation, 'translation');
            
            content.innerHTML = `
                <div class="mb-6">
                    <p class="text-lg mb-2">Cosa significa?</p>
                    <div class="text-4xl chinese-char mb-2">${word.character}</div>
                    <div class="text-lg text-gray-600 mb-4">${word.pinyin}</div>
                    <div class="grid grid-cols-2 gap-4">
                        ${options.map(option => `
                            <button onclick="checkAnswer('${option}', '${word.translation}')" 
                                    class="bg-gray-100 hover:bg-gray-200 border-2 border-gray-300 rounded-lg p-4 text-lg transition-all duration-200">
                                ${option}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function getRandomOptions(correct, type) {
            const options = [correct];
            const allOptions = chineseVocabulary.map(word => word[type]);
            
            while (options.length < 4) {
                const randomOption = allOptions[Math.floor(Math.random() * allOptions.length)];
                if (!options.includes(randomOption)) {
                    options.push(randomOption);
                }
            }
            
            return shuffleArray(options);
        }

        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        async function checkAnswer(userAnswer, correctAnswer) {
            const isCorrect = userAnswer === correctAnswer;
            const feedback = document.getElementById('exercise-feedback');
            
            // Disable all buttons
            document.querySelectorAll('#exercise-content button').forEach(btn => {
                btn.disabled = true;
                btn.classList.remove('hover:bg-gray-200');
                if (btn.textContent.trim() === correctAnswer) {
                    btn.classList.add('correct-answer');
                    btn.style.backgroundColor = config.success_color || defaultConfig.success_color;
                    btn.style.color = 'white';
                } else if (btn.textContent.trim() === userAnswer && !isCorrect) {
                    btn.style.backgroundColor = '#ef4444';
                    btn.style.color = 'white';
                }
            });
            
            // Show feedback
            feedback.innerHTML = `
                <div class="fade-in">
                    <div class="text-lg font-semibold ${isCorrect ? 'text-green-600' : 'text-red-600'}">
                        ${isCorrect ? '‚úÖ Corretto!' : '‚ùå Sbagliato!'}
                    </div>
                    ${!isCorrect ? `<div class="text-sm text-gray-600 mt-1">La risposta corretta √®: ${correctAnswer}</div>` : ''}
                </div>
            `;
            feedback.classList.remove('hidden');
            
            // Save result
            if (exerciseHistory.length < 999) {
                const result = await window.dataSdk.create({
                    exercise_id: currentExercise.id,
                    exercise_type: currentExerciseType,
                    user_answer: userAnswer,
                    correct_answer: correctAnswer,
                    is_correct: isCorrect,
                    completed_at: new Date().toISOString()
                });
                
                if (!result.isOk) {
                    console.error('Failed to save exercise result');
                }
            }
            
            document.getElementById('next-exercise-btn').classList.remove('hidden');
        }

        function nextExercise() {
            generateExercise();
        }

        function backToSelection() {
            document.getElementById('exercise-container').classList.add('hidden');
            document.getElementById('exercise-selection').classList.remove('hidden');
            currentExerciseType = '';
        }

        function updateStats() {
            stats.total = exerciseHistory.length;
            stats.correct = exerciseHistory.filter(ex => ex.is_correct).length;
            
            document.getElementById('total-exercises').textContent = stats.total;
            document.getElementById('correct-exercises').textContent = stats.correct;
            
            const accuracy = stats.total > 0 ? Math.round((stats.correct / stats.total) * 100) : 0;
            document.getElementById('accuracy-percentage').textContent = accuracy + '%';
        }

        function updateProgress() {
            const totalToday = exerciseHistory.filter(ex => {
                const today = new Date().toDateString();
                const exerciseDate = new Date(ex.completed_at).toDateString();
                return exerciseDate === today;
            }).length;
            
            const target = 10; // Daily target
            const progress = Math.min((totalToday / target) * 100, 100);
            
            document.getElementById('progress-bar').style.width = progress + '%';
            document.getElementById('progress-text').textContent = `${totalToday}/${target} oggi`;
        }

        // Initialize app when page loads
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99561805071b59fb',t:'MTc2MTYwOTAwNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
<button class="inline-flex items-center justify-center rounded-md px-4 py-2 text-base text-white font-semibold shadow-md hover:shadow-lg transform hover:-translate-y-0.5 transition-all duration-200 bg-gradient-to-r from-red-500 to-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 active:transform active:scale-95"> <a href="https://scottino2019-glitch.github.io/lingua-cinese/esercizi.html"> <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg></a></button>
</html>

